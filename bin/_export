#!/bin/bash

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )";
ROOT=${DIR}/..;

# environment variables
source ${ROOT}/.env;

exportDatabase()
{
    echo "Renaming previous SQL file...";

    DATE_TIME=$(date +%Y-%m-%d:%H:%M:%S);

    mv ${ROOT}/mysql/dumps/${MYSQL_DATABASE}.sql ${ROOT}/mysql/dumps/${MYSQL_DATABASE}.${DATE_TIME}.sql;

    echo "Dumping database into a new SQL file...";

    docker exec ${MYSQL_CONTAINER} mysqldump --opt -uroot -p${MYSQL_ROOT_PASSWORD} ${MYSQL_DATABASE} > ${ROOT}/mysql/dumps/${MYSQL_DATABASE}.sql;

    echo "Done :)";
}

exportDatabase;

exit 0;