#!/bin/bash

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )";
ROOT=${DIR}/..;

# environment variables
source ${ROOT}/.env;

exportDatabase()
{
    if [ -f ${ROOT}/mysql/dumps/${MYSQL_DATABASE}.sql ]; then
        DATE_TIME=$(date +%Y-%m-%d:%H:%M:%S);
        mv ${ROOT}/mysql/dumps/${MYSQL_DATABASE}.sql ${ROOT}/mysql/dumps/${MYSQL_DATABASE}.${DATE_TIME}.sql;
    fi;

    docker exec ${MYSQL_CONTAINER} mysqldump --opt -uroot -p${MYSQL_ROOT_PASSWORD} ${MYSQL_DATABASE} > ${ROOT}/mysql/dumps/${MYSQL_DATABASE}.sql;
}

exportDatabase;

exit 0;